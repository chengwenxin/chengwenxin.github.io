<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack åŸºç¡€çŸ¥è¯†æ•´ç† | Sunã®Blog</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/favicon.ico">
    <script src="/js/jq3.5.1.js"></script>
    <script src="/js/mouse.js"></script>
    <meta name="description" content="The Best or Nothing.">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/assets/css/0.styles.6a5893da.css" as="style"><link rel="preload" href="/assets/js/app.b9161754.js" as="script"><link rel="preload" href="/assets/js/3.89f5aeb4.js" as="script"><link rel="preload" href="/assets/js/1.f8fc9ec2.js" as="script"><link rel="preload" href="/assets/js/53.c04f220a.js" as="script"><link rel="prefetch" href="/assets/js/10.6864506f.js"><link rel="prefetch" href="/assets/js/11.977c1919.js"><link rel="prefetch" href="/assets/js/12.111dec6d.js"><link rel="prefetch" href="/assets/js/13.4fa287b8.js"><link rel="prefetch" href="/assets/js/14.23fc600f.js"><link rel="prefetch" href="/assets/js/15.eccc0bb9.js"><link rel="prefetch" href="/assets/js/16.a184c99a.js"><link rel="prefetch" href="/assets/js/17.c633f492.js"><link rel="prefetch" href="/assets/js/18.11af7635.js"><link rel="prefetch" href="/assets/js/19.f1f9d2d9.js"><link rel="prefetch" href="/assets/js/20.abb98ff1.js"><link rel="prefetch" href="/assets/js/21.5f561546.js"><link rel="prefetch" href="/assets/js/22.ee6439fb.js"><link rel="prefetch" href="/assets/js/23.c170ed15.js"><link rel="prefetch" href="/assets/js/24.e92f52f1.js"><link rel="prefetch" href="/assets/js/25.3a8ba8b4.js"><link rel="prefetch" href="/assets/js/26.ce88219f.js"><link rel="prefetch" href="/assets/js/27.15a14c57.js"><link rel="prefetch" href="/assets/js/28.b1ced503.js"><link rel="prefetch" href="/assets/js/29.f8b00d29.js"><link rel="prefetch" href="/assets/js/30.34e33fac.js"><link rel="prefetch" href="/assets/js/31.345b3d43.js"><link rel="prefetch" href="/assets/js/32.848634da.js"><link rel="prefetch" href="/assets/js/33.9312252a.js"><link rel="prefetch" href="/assets/js/34.abc55553.js"><link rel="prefetch" href="/assets/js/35.9aa68f94.js"><link rel="prefetch" href="/assets/js/36.247e8508.js"><link rel="prefetch" href="/assets/js/37.891192e3.js"><link rel="prefetch" href="/assets/js/38.efa74ba6.js"><link rel="prefetch" href="/assets/js/39.71dba9ac.js"><link rel="prefetch" href="/assets/js/4.a7af3649.js"><link rel="prefetch" href="/assets/js/40.b435650f.js"><link rel="prefetch" href="/assets/js/41.225aa291.js"><link rel="prefetch" href="/assets/js/42.179ada34.js"><link rel="prefetch" href="/assets/js/43.0c19b0cd.js"><link rel="prefetch" href="/assets/js/44.51f2a2f3.js"><link rel="prefetch" href="/assets/js/45.580125fc.js"><link rel="prefetch" href="/assets/js/46.82b8d158.js"><link rel="prefetch" href="/assets/js/47.4933bea4.js"><link rel="prefetch" href="/assets/js/48.1991c8a2.js"><link rel="prefetch" href="/assets/js/49.34164979.js"><link rel="prefetch" href="/assets/js/5.25e18dd7.js"><link rel="prefetch" href="/assets/js/50.90ba5948.js"><link rel="prefetch" href="/assets/js/51.917207ec.js"><link rel="prefetch" href="/assets/js/52.bc692118.js"><link rel="prefetch" href="/assets/js/54.3261da64.js"><link rel="prefetch" href="/assets/js/55.477fb918.js"><link rel="prefetch" href="/assets/js/56.90f832a9.js"><link rel="prefetch" href="/assets/js/57.30303129.js"><link rel="prefetch" href="/assets/js/58.0671661a.js"><link rel="prefetch" href="/assets/js/59.cc558ce5.js"><link rel="prefetch" href="/assets/js/6.b7642bc7.js"><link rel="prefetch" href="/assets/js/60.459a58ae.js"><link rel="prefetch" href="/assets/js/61.2fd38b86.js"><link rel="prefetch" href="/assets/js/62.161dbc8c.js"><link rel="prefetch" href="/assets/js/63.d82aa45e.js"><link rel="prefetch" href="/assets/js/64.c79113ac.js"><link rel="prefetch" href="/assets/js/65.52eedb72.js"><link rel="prefetch" href="/assets/js/66.5eb27d88.js"><link rel="prefetch" href="/assets/js/67.31abeb7b.js"><link rel="prefetch" href="/assets/js/68.10864ae5.js"><link rel="prefetch" href="/assets/js/69.e0db9da2.js"><link rel="prefetch" href="/assets/js/7.46fe6f5c.js"><link rel="prefetch" href="/assets/js/70.b0f44b7f.js"><link rel="prefetch" href="/assets/js/71.41c7f710.js"><link rel="prefetch" href="/assets/js/72.5ab8b785.js"><link rel="prefetch" href="/assets/js/73.0f401415.js"><link rel="prefetch" href="/assets/js/74.40a6c0e1.js"><link rel="prefetch" href="/assets/js/75.cc3e9a98.js"><link rel="prefetch" href="/assets/js/76.b5a78f78.js"><link rel="prefetch" href="/assets/js/77.b79fca89.js"><link rel="prefetch" href="/assets/js/78.2cdaba01.js"><link rel="prefetch" href="/assets/js/8.c442a4b1.js"><link rel="prefetch" href="/assets/js/9.c99fd3ae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6a5893da.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-2d5f533b><div data-v-2d5f533b><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-2d5f533b data-v-2d5f533b><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-2d5f533b data-v-2d5f533b><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>Sunã®Blog</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Vincent</span>
          Â Â 
          <span data-v-64685f0e>2017 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-2d5f533b><header class="navbar" data-v-2d5f533b><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Sunã®Blog" class="logo"> <span class="site-name">Sunã®Blog</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/å…´è¶£çˆ±å¥½/" class="nav-link"><i class="iconfont undefined"></i>
  å…´è¶£çˆ±å¥½
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç”Ÿæ´»ç‚¹æ»´/" class="nav-link"><i class="iconfont undefined"></i>
  ç”Ÿæ´»ç‚¹æ»´
</a></li><li class="dropdown-item"><!----> <a href="/categories/åŸåˆ›å†…å®¹/" class="nav-link"><i class="iconfont undefined"></i>
  åŸåˆ›å†…å®¹
</a></li><li class="dropdown-item"><!----> <a href="/categories/å…¶ä»–å†…å®¹/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–å†…å®¹
</a></li><li class="dropdown-item"><!----> <a href="/categories/è½¬è½½åˆ†äº«/" class="nav-link"><i class="iconfont undefined"></i>
  è½¬è½½åˆ†äº«
</a></li><li class="dropdown-item"><!----> <a href="/categories/æŠ€æœ¯éšç¬”/" class="nav-link"><i class="iconfont undefined"></i>
  æŠ€æœ¯éšç¬”
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      Tools
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/links/tools/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-menu"></i>
      LinksğŸˆ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/links/links/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chengwenxin" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-2d5f533b></div> <aside class="sidebar" data-v-2d5f533b><div class="personal-info-wrapper" data-v-ca798c94 data-v-2d5f533b><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-ca798c94> <h3 class="name" data-v-ca798c94>
    Vincent
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>61</h3> <h6 data-v-ca798c94>Article</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>24</h3> <h6 data-v-ca798c94>Tag</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/å…´è¶£çˆ±å¥½/" class="nav-link"><i class="iconfont undefined"></i>
  å…´è¶£çˆ±å¥½
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç”Ÿæ´»ç‚¹æ»´/" class="nav-link"><i class="iconfont undefined"></i>
  ç”Ÿæ´»ç‚¹æ»´
</a></li><li class="dropdown-item"><!----> <a href="/categories/åŸåˆ›å†…å®¹/" class="nav-link"><i class="iconfont undefined"></i>
  åŸåˆ›å†…å®¹
</a></li><li class="dropdown-item"><!----> <a href="/categories/å…¶ä»–å†…å®¹/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–å†…å®¹
</a></li><li class="dropdown-item"><!----> <a href="/categories/è½¬è½½åˆ†äº«/" class="nav-link"><i class="iconfont undefined"></i>
  è½¬è½½åˆ†äº«
</a></li><li class="dropdown-item"><!----> <a href="/categories/æŠ€æœ¯éšç¬”/" class="nav-link"><i class="iconfont undefined"></i>
  æŠ€æœ¯éšç¬”
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      Tools
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/links/tools/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-menu"></i>
      LinksğŸˆ
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/links/links/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/chengwenxin" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-2d5f533b><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>webpack åŸºç¡€çŸ¥è¯†æ•´ç†</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>Vincent</span>
          Â Â 
          <span data-v-64685f0e>2017 - </span>
          2020
        </a></span></div></div> <div data-v-2d5f533b><main class="page"><div class="page-title" style="display:none;"><h1 class="title">webpack åŸºç¡€çŸ¥è¯†æ•´ç†</h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>Vincent</span></i> <i class="iconfont reco-date" data-v-3b7f5bdf><span data-v-3b7f5bdf>2019-07-24</span></i> <!----> <i class="iconfont reco-tag tags" data-v-3b7f5bdf><span class="tag-item" data-v-3b7f5bdf>webpack</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="webpackç®€ä»‹"><a href="#webpackç®€ä»‹" class="header-anchor">#</a> webpackç®€ä»‹</h2> <p>webpackæ˜¯ä¸€ä¸ª <strong>æ¨¡å—æ‰“åŒ…å·¥å…·</strong>ï¼Œæ”¯æŒæ‰€æœ‰çš„æ‰“åŒ…è¯­æ³•ï¼Œæ¯”å¦‚ <code>ES Module</code>ã€<code>CommonJS</code>ã€<code>CMD</code>ã€<code>AMD</code>ã€‚åˆæœŸçš„webpackæ˜¯ç”¨æ¥æ¨¡å—æ‰“åŒ…jsçš„ï¼Œå‘å±•åˆ°ç°åœ¨ï¼Œå·²ç»å¯ä»¥æ‰“åŒ…å¾ˆå¤šç§æ–‡ä»¶ç±»å‹ï¼Œæ¯”å¦‚ <code>css</code>ã€<code>img</code> ã€‚</p> <p>ä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦æœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯ä¿æŒ <code>nodejs</code> å’Œ <code>webpack</code> ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚</p> <h2 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h2> <p>å®‰è£… <code>webpack</code> å»ºè®®æ ¹æ®é¡¹ç›®å®‰è£…è€Œä¸æ˜¯å…¨å±€å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli --save-dev

<span class="token comment"># æˆ–</span>

<span class="token function">yarn</span> <span class="token function">add</span> webpack webpack-cli --dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¿™ä¸ªæ—¶å€™æ‰§è¡Œ <code>webpack -v</code> æ˜¯æŸ¥ä¸åˆ°ç‰ˆæœ¬å·çš„ï¼Œå› ä¸º <code>nodejs</code> é»˜è®¤æ˜¯å»å…¨å±€æ‰¾ <code>webpack</code>ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œnodejsè¿˜æä¾›äº† <code>npx webpack -v</code> è¿™ä¸ªæ–¹æ³•ã€‚</p> <h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="header-anchor">#</a> è¿è¡Œ</h2> <p>å¦‚æœä¸ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œwebpackä¼šæŒ‰ç…§é»˜è®¤é…ç½®å»æ‰“åŒ…ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  <code>webpack.config.js</code> æ¥è‡ªå®šä¹‰é…ç½®ä¿¡æ¯ï¼Œé…ç½®æ–‡ä»¶çš„åå­—ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># é»˜è®¤é…ç½®æˆ–è€…é»˜è®¤é…ç½®æ–‡ä»¶</span>
npx webpack

<span class="token comment"># è‡ªå®šä¹‰é…ç½®å¹¶ä¸”ä¿®æ”¹é»˜è®¤é…ç½®åå­—</span>
npx webpack --config my-webpack-config.js

<span class="token comment"># npm scripts ä¸­é…ç½® &quot;build&quot;: &quot;webpack&quot;</span>
<span class="token function">npm</span> run build
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸€ä¸ªç®€å•çš„é…ç½®ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span> <span class="token comment">// productionï¼šé»˜è®¤ï¼Œç”Ÿäº§ç¯å¢ƒï¼Œä»£ç è¢«å‹ç¼©ï¼›developmentï¼šå¼€å‘ç¯å¢ƒï¼Œä»£ç ä¸å‹ç¼©</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å…¶ä¸­ <code>entry</code> å¯ä»¥å†™æˆè¿™æ ·ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>entry<span class="token operator">:</span> <span class="token punctuation">{</span>
  main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å…¶å®ï¼Œå¼€å§‹å®‰è£…çš„ <code>webpack-cli</code> å°±æ˜¯ä¸ºäº†åœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­å¯ä»¥æ­£ç¡®åœ°æ‰§è¡Œå‘½ä»¤è¡Œå·¥å…·ã€‚</p> <h2 id="loader"><a href="#loader" class="header-anchor">#</a> loader</h2> <p><code>webpack</code> å¯ä»¥ä½¿ç”¨ <code>loader</code> æ¥é¢„å¤„ç†æ–‡ä»¶ã€‚è¿™å…è®¸ä½ æ‰“åŒ…é™¤ <code>JavaScript</code> ä¹‹å¤–çš„ä»»ä½•é™æ€èµ„æºï¼Œjsçš„æ‰“åŒ…æ˜¯webpackå†…ç½®çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨ <code>Node.js</code> æ¥å¾ˆç®€å•åœ°ç¼–å†™è‡ªå·±çš„ <code>loader</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="file-loader"><a href="#file-loader" class="header-anchor">#</a> file-loader</h3> <p>å¤„ç†æ–‡ä»¶æ¨¡å—çš„ webpack loaderã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// è®¾ç½®è¾“å‡ºæ–‡ä»¶å</span>
            name<span class="token operator">:</span> <span class="token string">'[name]_[hash].[ext]'</span><span class="token punctuation">,</span>
            <span class="token comment">// è®¾ç½®è¾“å‡ºæ–‡ä»¶å¤¹</span>
            outputPath<span class="token operator">:</span> <span class="token string">'images/'</span><span class="token punctuation">,</span>
            <span class="token comment">// æŒ‡å®šç›®æ ‡æ–‡ä»¶çš„è‡ªå®šä¹‰å…¬å…±è·¯å¾„</span>
            publicPath<span class="token operator">:</span> <span class="token string">'assets/'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="url-loader"><a href="#url-loader" class="header-anchor">#</a> url-loader</h3> <p><code>file-loader</code> çš„å¢å¼ºç‰ˆï¼Œé™¤äº†ä¸Šè¿°åŠŸèƒ½ï¼Œè¿˜å¯ä»¥å°†æ–‡ä»¶è½¬æ¢ä¸º <code>base64 URI</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// è®¾ç½®è¾“å‡ºæ–‡ä»¶å</span>
            name<span class="token operator">:</span> <span class="token string">'[name]_[hash].[ext]'</span><span class="token punctuation">,</span>
            <span class="token comment">// è®¾ç½®éœ€è¦è½¬æ¢base64çš„æ–‡ä»¶å¤§å°ï¼ˆå¤ªå¤§çš„æ–‡ä»¶è½¬æ¢åéœ€è¦æ›´å¤§çš„è¯·æ±‚å‹åŠ›ï¼‰</span>
            limit<span class="token operator">:</span> <span class="token number">2048</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="cssç›¸å…³"><a href="#cssç›¸å…³" class="header-anchor">#</a> cssç›¸å…³</h3> <h4 id="style-loader-å’Œ-css-loader"><a href="#style-loader-å’Œ-css-loader" class="header-anchor">#</a> style-loader å’Œ css-loader</h4> <ul><li>css-loaderï¼šåŠ å…¥ a.css ä¸­å¼•å…¥äº† b.css å’Œ c.cssï¼Œcss-loader ä¼šå°†å…¶åˆå¹¶æˆä¸€ä¸ªcssæ–‡ä»¶</li> <li>style-loaderï¼šå°†åˆå¹¶åçš„ css æ–‡ä»¶æŒ‚è½½åˆ° head æ ‡ç­¾å†…</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="sass-loader"><a href="#sass-loader" class="header-anchor">#</a> sass-loader</h4> <p>å¦‚æœä½¿ç”¨ scssã€lessã€stylus ç­‰ css é¢„å¤„ç†å™¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ sass é¢„å¤„ç†å™¨ï¼Œé¦–å…ˆè¦å®‰è£… sass-loader å’Œ node-sassã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="custom-block warning"><p>loaderçš„åŠ è½½é¡ºåºæ˜¯ä»å³åˆ°å·¦ã€ä»ä¸‹åˆ°ä¸Šï¼Œæ‰€ä»¥å¤„ç† scss æ–‡ä»¶æ—¶ï¼Œå°† sass-loaderæ”¾åœ¨æœ€åã€‚</p></div> <h4 id="postcss-loader"><a href="#postcss-loader" class="header-anchor">#</a> postcss-loader</h4> <p>é€šè¿‡ postcss-loader æ¥ç»™æ–°å±æ€§æ·»åŠ å‚å•†å‰ç¼€ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span> 
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span> 
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// postcss.config.js</span>
<span class="token comment">// é¦–å…ˆå®‰è£… autoprefixer</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å¦‚æœ a.css ä¸­å¼•å…¥äº† b.css å’Œ c.cssï¼Œå½“è¯»åˆ° <code>@import('./b.css')</code> æ—¶å°±ä¼šç•¥è¿‡ postcss-loader å’Œ sass-loaderï¼Œç›´æ¥ä» css-loader ç›´æ¥è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ <code>importLoaders</code> é…ç½®æ¥æ”¹å–„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span> 
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              importLoaders<span class="token operator">:</span> <span class="token number">2</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h4 id="cssæ¨¡å—åŒ–"><a href="#cssæ¨¡å—åŒ–" class="header-anchor">#</a> cssæ¨¡å—åŒ–</h4> <p>åœ¨ <code>index.js</code> é€šè¿‡import <code>'./index.css'</code> å¼•å…¥æ ·å¼ä¼šå…¨å±€æœ‰æ•ˆï¼Œå¦‚æœæƒ³åœ¨æŸä¸ªæ¨¡å—æœ‰æ•ˆï¼Œå¦‚ä½•å»åšå‘¢ï¼Ÿ</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ¨¡å—A</span>

<span class="token keyword">import</span> style <span class="token keyword">from</span> <span class="token string">'index.css'</span>

<span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> headImg
img<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>style<span class="token punctuation">.</span>avator<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>

<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">'style-loader'</span><span class="token punctuation">,</span> 
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              importLoaders<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
              modules<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'postcss-loader'</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h4 id="å­—ä½“"><a href="#å­—ä½“" class="header-anchor">#</a> å­—ä½“</h4> <p>å­—ä½“æ–‡ä»¶åªéœ€è¦é€šè¿‡ file-loader å°†å­—ä½“æ–‡ä»¶è½¬ç§»åˆ°æ‰“åŒ…æ–‡ä»¶å¤¹å†…å³å¯ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(eot|ttf|svg|woff)$</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">{</span>
          loader<span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          options<span class="token operator">:</span> <span class="token punctuation">{</span>
            outputPath<span class="token operator">:</span> <span class="token string">'fonts/'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>  
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="plugin"><a href="#plugin" class="header-anchor">#</a> plugin</h2> <p>å¯ä»¥åœ¨webpackè¿è¡Œåˆ°æŸä¸ªæ—¶åˆ»çš„æ—¶å€™ï¼Œåšä¸€äº›äº‹æƒ…ã€‚</p> <h3 id="html-webpack-plugin"><a href="#html-webpack-plugin" class="header-anchor">#</a> html-webpack-plugin</h3> <p>ä¼šåœ¨æ‰“åŒ…ä¹‹åï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª html æ–‡ä»¶ï¼Œå¹¶æŠŠæ‰“åŒ…ç”Ÿæˆçš„ js è‡ªåŠ¨å¼•å…¥åˆ°è¿™ä¸ª html æ–‡ä»¶ä¸­ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>ä½†æ˜¯æˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨ index.html ä¸­å†™ä¸€äº›é»˜è®¤ä»£ç ï¼Œæ¯”å¦‚ metaï¼Œè¿™æ—¶å°±å¯ä»¥æŒ‰ç…§æŸä¸ªæ¨¡æ¿æ¥ç”Ÿæˆè¿™ä¸ª index.htmlã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    template<span class="token operator">:</span> <span class="token string">'src/index.html'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" class="header-anchor">#</a> clean-webpack-plugin</h3> <p>ä¼šåœ¨æ‰“åŒ…å‰å…ˆæ¸…ç©ºæ‰“åŒ…ç›®æ ‡æ–‡ä»¶å¤¹çš„æ–‡ä»¶ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span> <span class="token string">'src/index.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="å¤šä¸ªè¾“å‡ºæ–‡ä»¶"><a href="#å¤šä¸ªè¾“å‡ºæ–‡ä»¶" class="header-anchor">#</a> å¤šä¸ªè¾“å‡ºæ–‡ä»¶</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    sub<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>å¦‚æœæˆ‘ä»¬çš„æ‰“åŒ…åçš„æ–‡ä»¶ä¸­ï¼Œindex.html éœ€è¦ç»™åå°åšé…ç½®æ–‡ä»¶ï¼Œassets æ–‡ä»¶å¤¹éœ€è¦æ”¾åœ¨ cdn ä¸Šï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬çš„å°±éœ€è¦åœ¨ output ä¸­è®¾ç½® publicPathï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> CleanWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'clean-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    sub<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token string">'http://cdn.com.cn'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="sourcemap"><a href="#sourcemap" class="header-anchor">#</a> sourceMap</h2> <p>å¦‚æœè¿è¡Œæ‰“åŒ…åçš„æ–‡ä»¶ï¼ŒæŸä¸ªåœ°æ–¹æœ‰é”™è¯¯ï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºæ‰“åŒ…åçš„æ–‡ä»¶çš„æŸä¸ªä½ç½®æœ‰é”™è¯¯ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“é”™è¯¯æ¥è‡ªäºæºæ–‡ä»¶çš„æ‰€åœ¨ä½ç½®ï¼Œé‚£ä¹ˆå°±éœ€è¦å€ŸåŠ© sourceMap äº†ã€‚æ‰€ä»¥ sourceMap å…¶å®å°±æ˜¯ä¸€ç§æ˜ å°„ï¼Œå®ƒçŸ¥é“ dist ç›®å½• main.js æ–‡ä»¶çš„æŸä¸ªé”™è¯¯ï¼Œå®é™…å¯¹åº”çš„æ˜¯ src ç›®å½•ä¸‹ index.js æ–‡ä»¶çš„ç¬¬ä¸€è¡Œã€‚</p> <p>sourceMap é€šè¿‡é…ç½®ä¸­çš„ devtool å»é…ç½®ï¼Œå‚æ•°çš„å«ä¹‰å¤§æ¦‚æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p> <table><thead><tr><th>devtool</th> <th>ä½œç”¨</th></tr></thead> <tbody><tr><td>source-map</td> <td>ç”Ÿæˆ map æ–‡ä»¶ï¼Œé”™è¯¯ç²¾ç¡®åˆ°è¡Œå’Œåˆ—</td></tr> <tr><td>inline-source-map</td> <td>inlineï¼Œä¸ç”Ÿæˆ map æ–‡ä»¶ï¼Œä»¥ base64 å½¢å¼åµŒå…¥jsä¸­ï¼Œé”™è¯¯ç²¾ç¡®åˆ°è¡Œå’Œåˆ—</td></tr> <tr><td>cheap-source-map</td> <td>cheapï¼Œé”™è¯¯åªç²¾ç¡®åˆ°è¡Œï¼Œä¸”åªé’ˆå¯¹ä¸šåŠ¡ä»£ç ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸‰æ–¹æ¨¡å—</td></tr> <tr><td>cheap-module-source-map</td> <td>cheap-moduleï¼Œé”™è¯¯åªç²¾ç¡®åˆ°è¡Œï¼Œä¸”åªé’ˆå¯¹ä¸šåŠ¡ä»£ç ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹æ¨¡å—</td></tr> <tr><td>eval-source-map</td> <td>evalï¼Œä¸ç”Ÿæˆ map æ–‡ä»¶ï¼Œåœ¨ js ä¸­ä»¥ eval æ–¹æ³•çš„å½¢å¼å‡ºç°ï¼Œä½†æ˜¯å¤æ‚é¡¹ç›®çš„æç¤ºæ˜¯ä¸å…¨çš„</td></tr></tbody></table> <p><strong>æœ€ä½³å®è·µ</strong></p> <ol><li>developï¼šcheap-module-eval-source-mapï¼Œæç¤ºæ¯”è¾ƒå…¨ï¼Œæ‰“åŒ…é€Ÿåº¦å¿«</li> <li>productionï¼šcheap-module-source-mapï¼Œæç¤ºæ›´å…¨é¢ï¼Œæ‰“åŒ…ç¨å¾®æ…¢</li></ol> <h2 id="ç›‘å¬å˜åŠ¨"><a href="#ç›‘å¬å˜åŠ¨" class="header-anchor">#</a> ç›‘å¬å˜åŠ¨</h2> <h3 id="webpack-watch"><a href="#webpack-watch" class="header-anchor">#</a> webpack --watch</h3> <p>ç›‘å¬æ–‡ä»¶çš„å˜åŠ¨ï¼Œè‡ªåŠ¨è¿›è¡Œæ‰“åŒ…ã€‚</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="webpack-dev-server"><a href="#webpack-dev-server" class="header-anchor">#</a> webpack-dev-server</h3> <p>ä¸Šé¢çš„htmlçš„æ‰“å¼€çš„æ–¹å¼è¿˜æ˜¯éœ€è¦é€šè¿‡ <code>file</code> åè®®æ‰“å¼€ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ˜¯è¿™æ ·çš„ï¼š<code>file:///Users/reco/workSpace/git/personal/work/test.html</code>ã€‚è¿™æ ·çš„è¯å‘é€ <code>AJAX</code> è¯·æ±‚å°±æœ‰é—®é¢˜äº†ï¼Œå› ä¸ºå‘é€è¯·æ±‚éœ€è¦ <code>http</code> æˆ–è€… <code>https</code> åè®®ï¼Œè¿™æ—¶éœ€è¦çš„æ˜¯åœ¨æœ¬åœ°å¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© <code>webpack-dev-server</code> ï¼ˆæ‰“åŒ…æ—¶å°†æ‰“åŒ…çš„æ–‡ä»¶æ”¾åœ¨å†…å­˜ä¸­ï¼Œæé«˜æ‰“åŒ…é€Ÿåº¦ï¼‰ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> webpack-dev-server --dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    main<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    sub<span class="token operator">:</span> <span class="token string">'./src/index.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token string">'http://cdn.com.cn'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// é»˜è®¤ç«¯å£ 8080</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// æœ¬åœ°æœåŠ¡çš„æ ¹ç›®å½•</span>
    contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
    <span class="token comment">// æœåŠ¡å¯åŠ¨åè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// ç«¯å£</span>
    port<span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
    <span class="token comment">// è·¨åŸŸä»£ç†</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/api'</span><span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><strong>è‡ªå·±å†™ä¸€ä¸ªç®€å•çš„ webpack-dev-server</strong></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;server&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node server.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// server.js</span>

<span class="token keyword">const</span> espress <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webapck <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> complier <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// publicPath ä¸è®¾ç½®çš„è¯é»˜è®¤ '/'</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>complier<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  publicPath<span class="token operator">:</span> config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>publicPath
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server is running!'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><blockquote><p>**ç¼ºç‚¹ï¼š**éœ€è¦è‡ªå·±æ‰‹åŠ¨åˆ·æ–°</p></blockquote> <p>ä¸Šé¢è¿™ç§æ–¹å¼å°±æ˜¯åœ¨nodeä¸­ä½¿ç”¨webpackï¼Œè¿™æ˜¯é™¤äº†åœ¨å‘½ä»¤è¡Œä¸­çš„ä½¿ç”¨ <code>webpack</code> çš„å¦ä¸€ç§æ–¹å¼ã€‚</p> <p><strong>å¼€å¯ Hot Module Replacement</strong></p> <p>è§£å†³ä¸‹é¢çš„é—®é¢˜ï¼š</p> <ol><li>ä¿®æ”¹é¡µé¢æŸä¸ªé¢œè‰²ï¼Œé¡µé¢ä¼šåˆ·æ–°ï¼Œå¯¼è‡´åŠ¨æ€æ·»åŠ çš„ dom ä¼šæ¶ˆå¤±ï¼›</li> <li>ä¸€ä¸ªé¡µé¢åŒæ—¶å¼•å…¥ä¸¤ä¸ªæ¨¡å—çš„jsï¼Œä¿®æ”¹æŸä¸ªæ¨¡å—çš„jsï¼Œé¡µé¢ä¼šåˆ·æ–°ï¼Œå¯¼è‡´çµæ„Ÿä¸€ä¸ªæ¨¡å—çš„jsä¹Ÿä¼šåˆå§‹åŒ–ã€‚</li></ol> <p>å­˜åœ¨çš„é—®é¢˜ï¼š</p> <ol><li>åœ¨å¤šé¡µé¢åº”ç”¨é‡Œï¼Œhtmlæ›´æ”¹æ—¶å¹¶ä¸ä¼šåˆ·æ–°ï¼Œéœ€æ‰‹åŠ¨ï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥å»æ‰æ›´æ›´æ–°åŠŸèƒ½ã€‚</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. å¼€å¯ HMR</span>
    hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// åªæœ‰åœ¨å¼€å¯ HMR çš„æ—¶å€™æ‰ä¼šç›‘å¬å˜åŠ¨å¹¶åˆ·æ–°</span>
    hotOnly<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 2. æ’ä»¶</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>æ¡ˆä¾‹ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> counter <span class="token keyword">from</span> <span class="token string">'./counter'</span>
<span class="token keyword">import</span> number <span class="token keyword">from</span> <span class="token string">'./number'</span>

<span class="token function">counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// å¦‚æœ HMR ç”Ÿæ•ˆçš„è¯</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>hot<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç›‘å¬æ–‡ä»¶çš„å˜åŠ¨</span>
  module<span class="token punctuation">.</span>hot<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token string">'./number'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// åšä¸€äº›æ¸…ç©ºæ“ä½œ</span>
    <span class="token comment">// ...</span>

    <span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å½“å¼•ç”¨ css çš„æ—¶å€™åªéœ€è¦å¼•ç”¨ï¼Œå¹¶ä¸éœ€è¦ä¸Šé¢è¿™ä¸€å¨ä»£ç ï¼Œå°±æ˜¯å› ä¸º <code>css-loader</code> å·²ç»å†…ç½®äº†ä¸Šé¢çš„æ–¹æ³•ï¼Œå°±åƒåœ¨å†™ vueã€react ä»£ç ä¸éœ€è¦å†™ä¸Šé¢è¿™å¨ä»£ç ä¸€æ ·ï¼Œä»–ä»¬çš„ loader ä¸­ä¹Ÿå†…ç½®äº†è¿™äº›æ–¹æ³•ã€‚åªæœ‰åœ¨ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„æ–‡ä»¶ç±»å‹æ‰éœ€è¦ã€‚ï¼ˆreact æ˜¯å€ŸåŠ© babel-preset å®ç°çš„ï¼‰</p> <blockquote><p>ä¸šåŠ¡å¼€å‘æ—¶ï¼Œä¸€èˆ¬ä¸æ˜¯è®¾ç½® hotOnly è¿™æ ·æ‰èƒ½è¯•è¯•æ˜¾ç¤ºæœ€æ–°ä»£ç å’Œæ›´æ”¹æ•ˆæœ</p></blockquote> <h2 id="babel"><a href="#babel" class="header-anchor">#</a> Babel</h2> <h3 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="header-anchor">#</a> å®‰è£…</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># babel-loaderå°† webpack ä¸ babel å»ºç«‹å…³è”</span>
<span class="token comment"># @babel/core è¯­æ³•è½¬æ¢</span>

<span class="token function">npm</span> <span class="token function">install</span> --save-dev babel-loader @babel/core
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="è¯­æ³•è½¬æ¢"><a href="#è¯­æ³•è½¬æ¢" class="header-anchor">#</a> è¯­æ³•è½¬æ¢</h3> <p>è¿™ä¸ªæ—¶å€™è¿˜æ˜¯ä¸å¯ä»¥è½¬æ¢ï¼Œè¿˜éœ€è¦è¿™æ ·</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @babel/preset-env --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç„¶åé…ç½® options</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="å˜é‡ã€å¯¹è±¡è½¬æ¢"><a href="#å˜é‡ã€å¯¹è±¡è½¬æ¢" class="header-anchor">#</a> å˜é‡ã€å¯¹è±¡è½¬æ¢</h3> <p>è¿™ä¸ªæ—¶å€™ä¹Ÿåªèƒ½å¯¹ä¸€äº›è¯­æ³•è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚ â€œç®­å¤´å‡½æ•°â€ï¼Œå¦‚æœæƒ³è¦å¯¹ <code>Promise</code> è¿™äº›æ–°çš„å¯¹è±¡è¿›è¡Œè½¬æ¢ï¼ˆå‡†ç¡®æ¥è¯´ï¼Œæµè§ˆå™¨å¯èƒ½ä¸æ”¯æŒæ–°è§„èŒƒçš„çš„ä¸€äº›å¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦å•ç‹¬å°è£…è¿™äº›æ–¹æ³•ï¼Œç„¶ååœ¨å…¨å±€æ³¨å…¥ï¼‰ï¼Œè¿˜éœ€è¦è¿™æ ·ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save @babel/polyfill
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// åœ¨å…¥å£æ–‡ä»¶</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/polyfill&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// or</span>
<span class="token keyword">import</span> <span class="token string">&quot;@babel/polyfill&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¿™ä¸ªæ—¶å€™ä¼šé»˜è®¤å…¨éƒ¨è½¬æ¢ï¼Œè¿™æ ·ä¼šå¢åŠ å¾ˆå¤šå…¼å®¹æ€§ä»£ç ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŒ‰éœ€å¼•å…¥ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          useBuiltIns<span class="token operator">:</span> <span class="token string">'usage'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>æœ‰çš„åŒå­¦é—®ï¼š<code>babel-polyfill</code> è¿™æ ·å¼•ç”¨å¯ä¸å¯ä»¥ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ <code>useBuiltIns: 'usage'</code> æ—¶å°±ä¸å¯ä»¥äº†ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// åœ¨å…¥å£é…ç½®</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel-polyfill&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;./app/js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>@babel/preset-env</code> è¿˜å¯ä»¥æ‹¥æœ‰å…¶ä»–é…ç½®å‚æ•°ï¼Œæ¯”å¦‚ï¼š</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    targets<span class="token operator">:</span> <span class="token punctuation">{</span>
      chrome<span class="token operator">:</span> <span class="token string">&quot;67&quot;</span>
    <span class="token punctuation">}</span>ï¼Œ
    useBuiltIns<span class="token operator">:</span> 'usage'
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>ä¸Šé¢é…ç½®çš„æ„æ€æ˜¯ï¼Œåªéœ€è¦å…¼å®¹ chrome æµè§ˆå™¨ 67 ç‰ˆæœ¬ä»¥ä¸Šå°±å¯ä»¥äº†ï¼Œè¿™æ ·è½¬è¯‘æ—¶ä¼šæ ¹æ®æµè§ˆå™¨çš„å…¼å®¹æ€§æ¥åˆç†å¤„ç†è½¬è¯‘ç»“æœã€‚</p> <h3 id="ç»„ä»¶åº“çš„å°è£…"><a href="#ç»„ä»¶åº“çš„å°è£…" class="header-anchor">#</a> ç»„ä»¶åº“çš„å°è£…</h3> <p>å¦‚æœåªæ˜¯å¼€å‘ä¸šåŠ¡ä»£ç ï¼Œä½¿ç”¨ä¸Šé¢ <code>presets</code> + <code>babel-polyfill</code> çš„æ–¹å¼å°±å¯ä»¥äº†ï¼Œä½†æ˜¯ <code>babel-polyfill</code> æœ‰ä¸€ä¸ªç¡®å®šå°±æ˜¯ä¼šå°†å˜é‡å…¨å±€æ³¨å…¥ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ <code>transform-runtime</code> æ¥ä»¥é—­åŒ…ï¼ˆæˆ–å…¶ä»–ï¼‰çš„å½¢å¼æ¥è¿›è¡Œå¼•å…¥ï¼Œé¿å…å…¨å±€ç¯å¢ƒçš„æ±¡æŸ“ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev @babel/plugin-transform-runtime

<span class="token function">npm</span> <span class="token function">install</span> --save @babel/runtime
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
      test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> 
      loader<span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              <span class="token string">&quot;absoluteRuntime&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
              <span class="token string">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
              <span class="token string">&quot;helpers&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token string">&quot;regenerator&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token string">&quot;useESModules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>å°† <code>corejs</code> çš„å€¼è®¾ç½®ä¸º 2ï¼Œæ‰ä¼šå°† <code>map</code> ã€<code>promise</code>ç­‰æ–¹æ³•æ‰“åŒ…åˆ° <code>main.js</code>ï¼Œå½“ç„¶è¿˜éœ€è¦å¼•å…¥å¦ä¸€ä¸ªä¾èµ–ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save @babel/runtime-corejs2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="babelrc"><a href="#babelrc" class="header-anchor">#</a> <code>.babelrc</code></h3> <p>å¦‚æœ babel çš„é…ç½®è¿‡äºå¤æ‚ï¼Œå†…å®¹è¾ƒå¤šï¼Œå¯ä»¥å°†å…¶å•ç‹¬æ”¾åœ¨ <code>.babelrc</code> æ–‡ä»¶å†…ï¼š</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    useBuiltIns<span class="token operator">:</span> 'usage'
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="reactæ‰“åŒ…"><a href="#reactæ‰“åŒ…" class="header-anchor">#</a> Reactæ‰“åŒ…</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev @babel/preset-react
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      useBuiltIns<span class="token operator">:</span> 'usage'
    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;pragma&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dom&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default pragma is React.createElement</span>
        <span class="token property">&quot;pragmaFrag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DomFrag&quot;</span><span class="token punctuation">,</span> <span class="token comment">// default is React.Fragment</span>
        <span class="token property">&quot;throwIfNamespace&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// defaults to true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> Tree Shaking</h2> <blockquote><p>åªæ”¯æŒ ES Moduleï¼Œå› ä¸º ES Module æ˜¯é™æ€å¼•å…¥</p></blockquote> <p>ä½œç”¨ï¼šæ¨¡å—æŒ‰éœ€å¼•å…¥ï¼Œä¸ä¼šå°†å…¨éƒ¨ä»£ç å¼•ç”¨è¿‡æ¥</p> <h3 id="development"><a href="#development" class="header-anchor">#</a> development</h3> <p><strong>webpack.config.js</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    usedExports<span class="token operator">:</span> ture
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>usedExports</code> æ„æ€å°±æ˜¯æ£€æŸ¥ä¸€ä¸‹å“ªäº›æ¨¡å—è¢«ä½¿ç”¨äº†å†åšæ‰“åŒ…ã€‚</p> <p><strong>package.json</strong></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å¦‚æœå¼•å…¥çš„ä¸€äº› <code>css</code> æˆ–ä¾èµ–ä¸éœ€è¦ <code>Tree Shaking</code>ï¼Œé‚£å°† <code>sideEffects</code> è®¾ç½®ä¸º <code>[&quot;./a.css&quot;, &quot;@babel/polyfill&quot;]</code>ï¼Œå¦‚æœæ²¡æœ‰éœ€è¦é…ç½®çš„ï¼Œç›´æ¥è®¾ç½®ä¸º  <code>false</code> å³å¯ã€‚</p> <h3 id="production"><a href="#production" class="header-anchor">#</a> production</h3> <p>çº¿ä¸Šç¯å¢ƒæ˜¯ä¸éœ€è¦é…ç½® <code>usedExports</code> çš„ï¼Œä½†æ˜¯è¿˜æ˜¯éœ€è¦é…ç½® <code>package.json</code>ã€‚</p> <h2 id="é…ç½®æ–‡ä»¶æ•´ç†"><a href="#é…ç½®æ–‡ä»¶æ•´ç†" class="header-anchor">#</a> é…ç½®æ–‡ä»¶æ•´ç†</h2> <p>æ¯”å¦‚åœ¨ <code>Vue</code> å®˜æ–¹çš„è„šæ‰‹æ¶ä¸­ <code>webpack</code> çš„é…ç½®æ–‡ä»¶éƒ½æ”¾åœ¨ <code>build</code> æ–‡ä»¶å¤¹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œæ•´ç†çš„è¯ï¼Œéœ€è¦åšä¸€ä¸‹å¤„ç†ï¼š</p> <ol><li><p>å°†å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒçš„å…¬å…±é…ç½®æå–åˆ° <code>/build/webpack.base.js</code> ä¸­</p></li> <li><p>åˆ†åˆ«åœ¨å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒçš„é…ç½®ä¸­åˆå¹¶å…¬å…±é…ç½®ï¼Œé…ç½®åˆå¹¶éœ€è¦ä½¿ç”¨ <code>webpack-merge</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /build/webpack.dev.js</span>
<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> baseConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.base.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>baseConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>ä¿®æ”¹ <code>package.json</code></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config ./build/webpack.dev.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config ./build/webpack.prod.js&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>è¿™ä¸ªæ—¶å€™è¾ƒä¹‹å‰æ‰“åŒ…è¾“å‡ºå’Œæ¸…ç©ºçš„ç›®å½•å°±åº”è¯¥ä¿®æ”¹ä¸€ä¸‹äº†</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      template<span class="token operator">:</span> <span class="token string">'src/index.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;dist&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      root<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>æ›´æ–°</strong>ï¼šä¸Šé¢ <code>CleanWebpackPlugin</code> çš„è¯­æ³•æ˜¯ <code>1.0</code> ç‰ˆæœ¬çš„ã€‚<code>2.0</code> å®ƒæ‰€æ¸…ç©ºçš„æ–‡ä»¶å¤¹é»˜è®¤å°±æ˜¯æ‰“åŒ…è¾“å‡ºç›®å½•ï¼Œæ— éœ€å†å•ç‹¬æŒ‡å®šã€‚</p></li></ol> <h2 id="code-splitting"><a href="#code-splitting" class="header-anchor">#</a> Code Splitting</h2> <h3 id="åŸç†"><a href="#åŸç†" class="header-anchor">#</a> åŸç†</h3> <p>ä»£ç æ‹†åˆ†â€”â€”é€šè¿‡å¯¹å…¬ç”¨ä»£ç çš„æ‹†åˆ†æ¥æå‡æ€§èƒ½ã€‚</p> <p>æœ¬æ¥ä»£ç æ‹†åˆ†å’Œ <code>webpack</code> æ˜¯æ²¡å…³ç³»çš„ï¼Œåªä¸è¿‡æ˜¯ä¸€ç§ä¼˜åŒ–æ‰‹æ®µï¼Œæ¯”å¦‚å°†å…¬å…±ä»£ç å•ç‹¬æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œä¸šåŠ¡ä»£ç æ‰“åŒ…åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œä»è€Œæå‡åŠ è½½ä½“éªŒã€‚è¿™é‡Œå¯ä»¥è¿ç”¨å¤šå…¥å£æ–‡ä»¶çš„æ–¹å¼åˆ†å¼€æ‰“åŒ…ã€‚</p> <h3 id="webpackå®ç°"><a href="#webpackå®ç°" class="header-anchor">#</a> webpackå®ç°</h3> <p><code>webpack4.0</code> å®ç°ä»£ç åˆ†å‰²ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š</p> <ol><li>åŒæ­¥ä»£ç éœ€è¦é…ç½® <code>splitChunks</code></li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      chunks<span class="token operator">:</span> <span class="token string">&quot;all&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="2"><li>å¼‚æ­¥ä»£ç ä¸éœ€è¦åšä»»ä½•æ“ä½œï¼Œå¼‚æ­¥ä»£ç æ¯”å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> element
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>è¿™ä¸ªå†™æ³•ä¼šæŠ¥é”™ï¼Œå› ä¸ºåŠ¨æ€æ¥è·å–ä¾èµ–çš„è¿™ç§æ–¹å¼æ˜¯è¯•éªŒæ€§è¯­æ³•ï¼Œç›®å‰è¿˜ä¸æ”¯æŒï¼Œéœ€è¦å€ŸåŠ©æ’ä»¶ï¼š<code>babel-plugin-dynamic-import-webpack</code></p></blockquote> <hr> <h3 id="splitchunksplugin"><a href="#splitchunksplugin" class="header-anchor">#</a> SplitChunksPlugin</h3> <p><strong>é­”æ³•æ³¨é‡Š</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'loadsh' */</span><span class="token punctuation">,</span> <span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> element
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><code>babel-plugin-dynamic-import-webpack</code> ä¸æ”¯æŒé­”æ³•æ³¨é‡Šï¼Œæ‰€ä»¥è¦æ¢æˆ <code>@babel/plugin-syntax-dynamic-import</code>ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæ‰“åŒ…ç”Ÿæˆ <code>vendors~lodash.js</code>ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹æ‰“åŒ…åçš„åå­—ï¼Œå¯ä»¥è®¾ç½® <code>optimization</code>ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      chunks<span class="token operator">:</span> <span class="token string">&quot;async&quot;</span><span class="token punctuation">,</span> <span class="token comment">// async å¼‚æ­¥ï¼Œinitial åŒæ­¥ï¼Œ all å…¨éƒ¨ï¼Œä½†æ˜¯åŒæ­¥è¿˜éœ€è¦é…ç½® cacheGroupsï¼Œè¿™æ˜¯é‡ç‚¹</span>
      minSize<span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token comment">// å¯ä»¥å¤„ç†ä¾èµ–çš„æœ€å°å€¼</span>
      maxSize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// å¯ä»¥å¤„ç†ä¾èµ–çš„æœ€å¤§å€¼</span>
      minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// è¢«å¼•ç”¨2æ¬¡åŠä»¥ä¸Šï¼Œæ‰ä¼šè¢«æ‹†åˆ†</span>
      maxAsyncRequests<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment">// æœ€å¤§è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ‹†åˆ†æ—¶æœ€å¤šæ‹†åˆ†5ä¸ªåŒ…</span>
      maxInitialRequests<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment">// å…¥å£æœ€å¤§è¯·æ±‚æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ‹†åˆ†æ—¶æœ€å¤šæ‹†åˆ†3ä¸ªåŒ…</span>
      automaticNameDelimiter<span class="token operator">:</span> <span class="token string">'~'</span><span class="token punctuation">,</span> <span class="token comment">// æ–‡ä»¶ç”Ÿæˆæ—¶åå­—çš„è¿æ¥ç¬¦</span>
      name<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// æ‹†åˆ†å—çš„åç§°ï¼Œæä¾›trueå°†æ ¹æ®å—å’Œç¼“å­˜ç»„å¯†é’¥è‡ªåŠ¨ç”Ÿæˆåç§°ã€‚</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        vendors<span class="token operator">:</span> <span class="token punctuation">{</span>
          test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// ä¼˜å…ˆçº§ï¼Œæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼Œç¬¦åˆå¤šä¸ªè§„åˆ™æ—¶ä¼˜å…ˆæƒé‡é«˜çš„è§„åˆ™</span>
          filename<span class="token operator">:</span> <span class="token string">&quot;venders.js&quot;</span> <span class="token comment">// æ‰“åŒ…æ—¶çš„åå­—</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// ä¸åœ¨ verdors å†…çš„æ‰“åŒ…</span>
        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          minChunks<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            priority<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span>
            reuseExistingChunk<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// å¦‚æœä¸€ä¸ªæ¨¡å—è¢«æ‰“åŒ…è¿‡äº†ï¼Œå†æ¬¡é‡åˆ°ï¼Œå°±ä¸ä¼šå†æ‰“åŒ…äº†ï¼Œè€Œæ˜¯ä¼šå»æ‰¾ä¹‹å‰æ‰“åŒ…è¿‡çš„é‚£ä¸ªæ¨¡å—</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>  
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="lazy-loading-chunk"><a href="#lazy-loading-chunk" class="header-anchor">#</a> Lazy Loading &amp; Chunk</h2> <h3 id="lazy-loading"><a href="#lazy-loading" class="header-anchor">#</a> Lazy Loading</h3> <p><code>webpack</code> å¯ä»¥è¯†åˆ« <code>ECMAScript</code> çš„importè¿”å›çš„promiseï¼Œå¹¶è¿›è¡Œåˆ†å‰²ï¼Œå®ç°æ‡’åŠ è½½ï¼Œä½†æ˜¯å¿…é¡»ä¾èµ– <code>babel-polyfill</code> æˆ–è€… <code>promise-polyfill</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'loadsh' */</span><span class="token punctuation">,</span> <span class="token string">'lodash'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
    div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> element
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ç”¨ <code>ES7</code> çš„ <code>async</code> å’Œ <code>await</code> å‡½æ•°é‡æ„ä¸€ä¸‹ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: 'loadsh' */</span><span class="token punctuation">,</span> <span class="token string">'lodash'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> element
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">createElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="chunk"><a href="#chunk" class="header-anchor">#</a> Chunk</h3> <p>åƒä¸Šé¢çš„ <code>Lazy Loading</code> æ‰€æ‹†åˆ†æ‰“åŒ…çš„æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª <code>Chunk</code>ï¼Œè€Œå‰é¢çš„é…ç½®å‚æ•°<code>minChunks: 2</code> çš„æ„æ€å°±æ˜¯ï¼šå½“æœ‰2ä¸ªä»¥ä¸Šçš„ Â· ä½¿ç”¨åˆ°æŸä¸ªä¾èµ–æ—¶ï¼Œæ‰ä¼šå¯¹å…¶è¿›è¡Œæ‹†åˆ†æˆä¸€ä¸ª <code>Chunk</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token string">'http://cdn.com.cn'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    chunkFilename<span class="token operator">:</span> <span class="token string">'[name].chunk.js'</span><span class="token punctuation">,</span> <span class="token comment">// æ‰“åŒ…ä¹‹åçš„å…¥å£æ–‡ä»¶ä¹‹å¤–çš„jsçš„ä¼šåœ¨è¿™é‡Œè¿‡æ»¤ä¸€ä¸‹åå­—</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="æ‰“åŒ…åˆ†æ"><a href="#æ‰“åŒ…åˆ†æ" class="header-anchor">#</a> æ‰“åŒ…åˆ†æ</h2> <p><code>http://webpack.js.org/guides/code-splitting/#bundle-analysis</code>ï¼Œè¿™æ˜¯å®˜ç½‘å¯¹æ‰“åŒ…åˆ†æçš„å‡ ä¸ªæ€»ç»“ï¼Œå…¶ä¸­æœ€å¥½ç”¨çš„æ˜¯ <code>webpack-bundle-analyzer</code>ã€‚</p> <p><strong>webpack å¸Œæœ›æˆ‘ä»¬æ€ä¹ˆæ ·å†™ä»£ç å‘¢ï¼Ÿ</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// åŸæ¥æˆ‘ä»¬æ˜¯è¿™ä¹ˆå†™ä»£ç çš„</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token number">123</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ä¸Šé¢çš„ä»£ç çš„åŠ è½½åˆ©ç”¨ç‡æ˜¯è¾ƒä½çš„ï¼Œå› ä¸ºåˆ›å»ºå…ƒç´ å®åœ¨ç‚¹å‡»äº‹ä»¶è§¦å‘åæ‰è§¦å‘çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ†ç¦»å‡ºå»ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</span>

<span class="token comment">// å°†ç”Ÿæˆä»£ç çš„ä»£ç æ”¾åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å»ï¼Œæ¯”å¦‚å« click.js</span>
<span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token number">123</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> createElement


document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./click.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> func<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>æ‰€ä»¥æˆ‘ä»¬ç°åœ¨å†™ä»£ç åº”è¯¥è€ƒè™‘çš„ä¸æ˜¯ç¼“å­˜çš„é—®é¢˜ï¼Œè€Œæ˜¯ä»£ç çš„åˆ©ç”¨ç‡ã€‚æ‰€ä»¥åœ¨ <code>chunks</code> é»˜è®¤è®¾ç½®ä¸º <code>async</code> è€Œä¸æ˜¯ <code>all</code>ï¼Œæ˜¯å› ä¸ºï¼ŒåŒæ­¥çš„ä»£ç åªèƒ½å¢åŠ ç¼“å­˜ï¼Œè€Œå¯¹æ€§èƒ½æå‡éå¸¸æœ‰é™ã€‚</p> <blockquote><p>è°·æ­Œæµè§ˆå™¨æŸ¥çœ‹ç½‘é¡µçš„åˆ©ç”¨ç‡ï¼šæ§åˆ¶å° --&gt; ctrl+shift+p --&gt; coverage</p></blockquote> <hr> <p>æ¯”å¦‚ç‚¹å‡»ç™»å½•çš„æ—¶å€™ä¼šå‡ºç°ä¸€ä¸ªæ¨¡æ€æ¡†ï¼Œé¦–é¡µçš„åŠ è½½å¹¶ä¸éœ€è¦åŠ è½½æ¨¡æ€æ¡†çš„ï¼Œä½†æ˜¯ç‚¹å‡»ç™»å½•æŒ‰é’®å†åŠ è½½ï¼Œæ¨¡æ€æ¡†çš„åŠ è½½æ˜¯ä¼šå˜æ…¢çš„ï¼Œè¿™å°±éœ€è¦ä¸‹é¢çš„ä¸¤ä¸ªæ–¹æ³•äº†ï¼š<code>Preloading</code> å’Œ <code>Prefetching</code>ã€‚</p> <h3 id="prefetching"><a href="#prefetching" class="header-anchor">#</a> Prefetching</h3> <p><strong>éä¸»è¦ä¸šåŠ¡æ¨¡å—ä¼šåœ¨ä¸»è¦ä¸šåŠ¡æ¨¡å—åŠ è½½å®Œä¹‹åï¼Œç©ºé—²æ—¶é—´å†å»åŠ è½½ã€‚</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</span>

<span class="token comment">// å°†ç”Ÿæˆä»£ç çš„ä»£ç æ”¾åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å»ï¼Œæ¯”å¦‚å« click.js</span>
<span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token number">123</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> createElement


document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// é€šè¿‡é­”æ³•æ³¨é‡Šæ¥å¼€å¯ webpackPrefetch</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span><span class="token string">'./click.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> func<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="preloading"><a href="#preloading" class="header-anchor">#</a> Preloading</h3> <p><strong>è€Œè¿™ä¸ªæ¨¡å¼ä¸‹ï¼Œéä¸»è¦ä¸šåŠ¡æ¨¡å—ä¼šå’Œä¸»è¦ä¸šåŠ¡æ¨¡å—ä¸€èµ·åŠ è½½</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™</span>

<span class="token comment">// å°†ç”Ÿæˆä»£ç çš„ä»£ç æ”¾åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­å»ï¼Œæ¯”å¦‚å« click.js</span>
<span class="token keyword">function</span> <span class="token function">createElement</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token number">123</span>
  documnet<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> createElement


document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// é€šè¿‡é­”æ³•æ³¨é‡Šæ¥å¼€å¯ webpackPreload</span>
  <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span><span class="token string">'./click.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token keyword">default</span><span class="token operator">:</span> func<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h3> <p>ç›®å‰è€ƒè™‘å‰ç«¯çš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¸èƒ½æ€»æ˜¯è€ƒè™‘ç¼“å­˜ï¼Œè€Œæ˜¯ä¸»è¦è€ƒè™‘ä»£ç çš„ä½¿ç”¨ç‡ã€‚</p> <h2 id="cssä»£ç åˆ†å‰²"><a href="#cssä»£ç åˆ†å‰²" class="header-anchor">#</a> CSSä»£ç åˆ†å‰²</h2> <h3 id="cssåˆ†å‰²"><a href="#cssåˆ†å‰²" class="header-anchor">#</a> CSSåˆ†å‰²</h3> <p>ä¸åšå¤„ç†çš„æƒ…å†µä¸‹ï¼Œ<code>webpack</code> ä¼šå°† <code>css</code> æ‰“åŒ…åˆ° <code>js</code> ä¸­å»ï¼Œå¦‚æœéœ€è¦ç”Ÿæˆå•ç‹¬çš„ <code>css</code> æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>MiniCssExtractPlugin</code>ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å®‰è£…</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev mini-css-extract-plugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>é…ç½®æ­¥éª¤ï¼š</p> <ol><li>é…ç½® <code>plugins</code>ï¼›</li> <li>å°† <code>style-loader</code> æ”¹ä¸º <code>MiniCssExtractPlugin.loader</code>ï¼›</li> <li>å¦‚æœè®¾ç½®äº† <code>Tree Shaking</code>ï¼Œéœ€è¦å°† <code>&quot;sideEffects&quot;: false</code> æ”¹ä¸º <code>&quot;sideEffects&quot;: [&quot;*.css&quot;]</code>ã€‚</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// è®¾ç½®è¾“å‡ºæ–‡ä»¶çš„å‘½åè§„åˆ™</span>
      filename<span class="token operator">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
      chunkFilename<span class="token operator">:</span> <span class="token string">'[id].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token comment">// you can specify a publicPath here</span>
              <span class="token comment">// by default it uses publicPath in webpackOptions.output</span>
              publicPath<span class="token operator">:</span> <span class="token string">'../'</span><span class="token punctuation">,</span>
              hmr<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    usedExports<span class="token operator">:</span> ture
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;*.css&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="css-å‹ç¼©"><a href="#css-å‹ç¼©" class="header-anchor">#</a> CSS å‹ç¼©</h3> <p><code>optimize-css-assets-webpack-plugin</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> OptimizeCSSAssetsPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'optimize-css-assets-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">OptimizeCSSAssetsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="åˆå¹¶-css"><a href="#åˆå¹¶-css" class="header-anchor">#</a> åˆå¹¶ CSS</h3> <p>å°†å¤šä¸ªå…¥å£æ–‡ä»¶çš„ <code>css</code> å•ç‹¬æ”¾åˆ°æ¯ä¸ªæ–‡ä»¶ä¸­ï¼Œéœ€è¦è®¾ç½® <code>optimization.splitChunks.cacheGroups</code> ä¸ºå¯¹åº”çš„å¤šä¸ªåˆ†ç»„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">recursiveIssuer</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>issuer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">recursiveIssuer</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>issuer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> m<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/foo'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    bar<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src/bar'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    splitChunks<span class="token operator">:</span> <span class="token punctuation">{</span>
      cacheGroups<span class="token operator">:</span> <span class="token punctuation">{</span>
        fooStyles<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
          test<span class="token operator">:</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> c<span class="token punctuation">,</span> entry <span class="token operator">=</span> <span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            m<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'CssModule'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">recursiveIssuer</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">===</span> entry<span class="token punctuation">,</span>
          chunks<span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
          enforce<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        barStyles<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>
          test<span class="token operator">:</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> c<span class="token punctuation">,</span> entry <span class="token operator">=</span> <span class="token string">'bar'</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            m<span class="token punctuation">.</span>constructor<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'CssModule'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">recursiveIssuer</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">===</span> entry<span class="token punctuation">,</span>
          chunks<span class="token operator">:</span> <span class="token string">'all'</span><span class="token punctuation">,</span>
          enforce<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h2 id="æµè§ˆå™¨ç¼“å­˜"><a href="#æµè§ˆå™¨ç¼“å­˜" class="header-anchor">#</a> æµè§ˆå™¨ç¼“å­˜</h2> <p><code>contenthash</code> å¦‚æœå†…å®¹æ²¡æœ‰å˜åŒ–ï¼Œhashå€¼ä¸ä¼šå˜ï¼›å¦‚æœå†…å®¹å˜åŒ–ï¼Œhashå°±ä¼šå˜ã€‚è¿™æ ·é¡¹ç›®é‡æ–°æ‰“åŒ…ä¸Šçº¿åï¼Œé¡¹ç›®å°±ä¸ä¼šå…¨éƒ¨é‡æ–°åŠ è½½äº†ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token string">'http://cdn.com.cn'</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].[contenthash].js'</span><span class="token punctuation">,</span>
    chunkFilename<span class="token operator">:</span> <span class="token string">'[name].[contenthash].chunk.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å¦‚æœ <code>webpack</code> æ˜¯è€ç‰ˆæœ¬ï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸‹ <code>runtimeChunk</code>ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'runtime'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>è¿™æ˜¯å› ä¸ºï¼šä»£ç æœ‰æ²¡æœ‰å˜åŒ–çš„é€»è¾‘å…³ç³»è¢«æ‰“åŒ…åˆ°ä¸€ä¸ªå« <code>manifest</code> çš„ä¸œè¥¿æ¥é‡Œï¼Œæ—§ç‰ˆæœ¬çš„ <code>webpack</code> æ˜¯ä¼šå°†è¿™ä¸ªä¸œè¥¿ç›´æ¥æ‰“åŒ…åˆ°æ¯ä¸ª <code>chunk</code> æ–‡ä»¶ä¸­ï¼Œè€Œæ‰€ä»¥å¯¼è‡´æ¯æ¬¡æ‰“åŒ…éƒ½ä¸ä¸€è‡´ï¼Œè¿™æ ·çš„è¯é…ç½®å¥½ <code>runtimeChunk</code>ä¹‹åï¼Œæ‰€æœ‰çš„<code>manifest</code> éƒ½ä¼šæå–åˆ°åä¸º <code>runtime</code> çš„æ–‡ä»¶å†…ï¼Œæ‰€ä»¥å°±ä¸ä¼šå½±å“æ‰“åŒ…äº†ã€‚</p> <h2 id="shimming-å«ç‰‡"><a href="#shimming-å«ç‰‡" class="header-anchor">#</a> Shimming (å«ç‰‡)</h2> <p><code>babel-polyfill</code> å°±æ˜¯ä¸€ä¸ªå…¨å±€å«ç‰‡ï¼Œ<code>babel-plugin-transform-runtime</code> æ˜¯ä¸€ä¸ªå±€éƒ¨å«ç‰‡ã€‚ä¸‹é¢ä»‹ç»å‡ ç§å«ç‰‡ï¼š</p> <ol><li><p>å¦‚æœæˆ‘ä»¬åœ¨ <code>a.js</code> å¼•ç”¨äº†ä¸€ä¸ª <code>utils.js</code> çš„é‡Œé¢çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•éœ€è¦å€ŸåŠ© <code>jquery</code>ï¼Œ <code>a.js</code> å¼•ç”¨äº†<code>jquery</code>ï¼Œè€Œ <code>utils.js</code> æ²¡æœ‰ï¼Œè¿™æ—¶å€™æ˜¯ä¼šæŠ¥é”™çš„ï¼Œæ‰€ä»¥å¯ä»¥å€ŸåŠ© <code>webpack.ProvidePlugin</code> å…¨å±€ åœ¨ä½¿ç”¨ <code>$</code> çš„åœ°æ–¹å¼•ç”¨ <code>jquery</code>ã€‚</p></li> <li><p><code>webpack.ProvidePlugin</code> è¿˜æœ‰å¦å¤–ä¸€ä¸ªåŠŸèƒ½ï¼šå¦‚æœæˆ‘ä»¬æƒ³è¦å°† <code>$.each</code> åŠŸèƒ½ç›´æ¥è¿™æ ·ä½¿ç”¨ <code>$each</code>ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢è¿™ä¹ˆæ¥é…ç½®ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">'webpack'</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      $<span class="token operator">:</span> <span class="token string">'jquery'</span><span class="token punctuation">,</span>
      $each<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">,</span> <span class="token string">'each'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>æ¯ä¸ªæ¨¡å—çš„ <code>this</code> éƒ½æ˜¯æŒ‡å‘å½“å‰æ¨¡å—çš„ï¼Œå¦‚æœæƒ³è®©æ¯ä¸ªæ¨¡å—éƒ½æŒ‡å‘ <code>window</code>ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ© <code>imports-loader</code>ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'imports-loader?this=?window'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ol> <h2 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="header-anchor">#</a> ç¯å¢ƒå˜é‡</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.common.js</span>

<span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-merge'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.dev.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.prod.js'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>env <span class="token operator">&amp;&amp;</span> env<span class="token punctuation">.</span>production<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dev-build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config ./build/webpack.common.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config ./build/webpack.common.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --env.production --config ./build/webpack.common.js&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="åŒºåˆ†æ¨¡å¼æ‰“åŒ…"><a href="#åŒºåˆ†æ¨¡å¼æ‰“åŒ…" class="header-anchor">#</a> åŒºåˆ†æ¨¡å¼æ‰“åŒ…</h2> <p>åŒºåˆ«ï¼š</p> <ol><li>develop æ¨¡å¼ä¸‹çš„sourceMap æ˜¯éå¸¸å…¨çš„ï¼›</li> <li>develop æ¨¡å¼ä¸‹çš„ä»£ç ä¸éœ€è¦å‹ç¼©ï¼›</li></ol> <h2 id="å‡½æ•°åº“æ‰“åŒ…"><a href="#å‡½æ•°åº“æ‰“åŒ…" class="header-anchor">#</a> å‡½æ•°åº“æ‰“åŒ…</h2> <h3 id="æŒ‡å®šä»£ç è¿è¡ŒèŒƒå›´"><a href="#æŒ‡å®šä»£ç è¿è¡ŒèŒƒå›´" class="header-anchor">#</a> æŒ‡å®šä»£ç è¿è¡ŒèŒƒå›´</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'library.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    library<span class="token operator">:</span> <span class="token string">'library'</span><span class="token punctuation">,</span> <span class="token comment">// é€šè¿‡ script æ ‡ç­¾å¼•å…¥ï¼Œå…¨å±€æ³¨å…¥ library è¿™ä¸ªå˜é‡</span>
    libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span> <span class="token comment">// æ¨¡å—å¼•å…¥æ–¹å¼ ES Module å’Œ CommonJS</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><code>library</code> å’Œ <code>libraryTarget</code> ä¸¤ä¸ªæ˜¯é…åˆä½¿ç”¨çš„ï¼Œ<code>library</code> çš„æ„æ€å°±æ˜¯æŒ‡å®šæš´éœ²çš„å…¨å±€å˜é‡çš„åå­—ï¼Œä½†æ˜¯è¿™ä¸ªå…¨å±€å˜é‡æŒ‚åœ¨åˆ°å“ªé‡Œå‘¢ï¼Ÿè¿™å°±ç”± <code>libraryTarget</code> æ¥æŒ‡å®šäº†ã€‚<code>umd</code> çš„æ„æ€æ˜¯å…è®¸å®ƒä¸CommonJSï¼ŒAMDå’Œå…¨å±€å˜é‡ä¸€èµ·ä½¿ç”¨ï¼Œé™¤äº†å®ƒè¿˜æœ‰ <code>this/window/global/amd</code> ç­‰å€¼å¯ä»¥è®¾ç½®ã€‚</p> <h3 id="ç•¥è¿‡ä¸éœ€è¦çš„ä¾èµ–"><a href="#ç•¥è¿‡ä¸éœ€è¦çš„ä¾èµ–" class="header-anchor">#</a> ç•¥è¿‡ä¸éœ€è¦çš„ä¾èµ–</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'library.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    externals<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">]</span> <span class="token comment">// æ‰“åŒ…æ—¶å½“é‡åˆ° lodash è¿™ä¸ªä¾èµ–å°±è‡ªåŠ¨å¿½ç•¥</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>æ¯”å¦‚æˆ‘çš„è¿™ä¸ªå‡½æ•°åº“ä¾èµ– <code>jquery</code>ï¼Œä½†æ˜¯ç”¨æˆ·ä¹Ÿå¯èƒ½å¼•ç”¨äº† <code>jquery</code>ï¼Œè¿™æ ·å°±ä¼šå¤šæ‰“åŒ…ä¸€ä»½ï¼Œæ‰€ä»¥ä¸ºäº†å‡å°‘ä»£ç é‡ï¼Œè¿™æ—¶å°±å¯ä»¥é€šè¿‡ <code>externals</code> æ¥å¿½ç•¥ <code>jquery</code>ï¼ˆ<code>externals</code> æ”¯æŒ <code>Arrary/Object</code>ï¼‰ã€‚</p> <h2 id="progressive-web-application"><a href="#progressive-web-application" class="header-anchor">#</a> Progressive Web Application</h2> <p>ç¬¬ä¸€æ¬¡è®¿é—®æˆåŠŸï¼Œç¬¬äºŒæ¬¡è®¿é—®æ—¶å¦‚æœæœåŠ¡æŒ‚æ‰äº†ï¼Œè¿™ä¸ªæ—¶å€™è®©é¡¹ç›®èµ°ç¼“å­˜ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæœåŠ¡é”™è¯¯é¡µé¢ã€‚</p> <p><code>PWA</code> çš„æŠ€æœ¯åŸç†æ˜¯ <code>server work</code>ï¼Œè¿™é‡Œå¯ä»¥å€ŸåŠ© <code>workbox-webpack-plugin</code>ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> WorkboxPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'workbox-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">WorkboxPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      clientsClaim<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      skipWaiting<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>æ‰“åŒ…ä¹‹åå°±äº§ç”Ÿä¸¤ä¸ªæ–‡ä»¶ï¼š<code>service-work.js</code> å’Œ <code>precache-manifest.js</code>ï¼Œä¸‹é¢è¿˜éœ€è¦åœ¨å…¥å£æ–‡ä»¶å†™ä¸€ä¸‹ç›¸å…³é…ç½®ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// index.js</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'/service-work.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">registeration</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">service-work registered</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">service-work register error</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="typescript-çš„æ‰“åŒ…é…ç½®"><a href="#typescript-çš„æ‰“åŒ…é…ç½®" class="header-anchor">#</a> TypeScript çš„æ‰“åŒ…é…ç½®</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> ts-loader -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'production'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.tsx'</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.tsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'index.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>è¿˜éœ€è¦åˆ›å»º <code>tsconfig.json</code>ï¼š</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;outDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./dist&quot;</span><span class="token punctuation">,</span> <span class="token comment">// æ‰“åŒ…åˆ°é‚£ä¸ªæ–‡ä»¶å¤¹å†…</span>
    <span class="token property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es6&quot;</span><span class="token punctuation">,</span> <span class="token comment">// ä½¿ç”¨es6çš„æ¨¡å—åŒ–æ–¹å¼</span>
    <span class="token property">&quot;target&quot;</span><span class="token operator">:</span> <span class="token string">&quot;es5&quot;</span><span class="token punctuation">,</span> <span class="token comment">// æ‰“åŒ…æˆ es5 è¯­æ³•</span>
    <span class="token property">&quot;allowJs&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token comment">// å…è®¸åœ¨tsæ–‡ä»¶é‡Œåœ¨å¼•å…¥ä¸€äº›jsæ¨¡å—</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å¦‚æœæˆ‘ä»¬å¼•å…¥äº† <code>jquery</code> è¿™ä¸ªæ¨¡å—ï¼Œè¦æƒ³åœ¨ä½¿ç”¨ <code>jquery</code> è¯­æ³•æ—¶è®©typescriptæœ‰æ•ˆï¼Œè¿˜éœ€è¦å¼•å…¥ <code>@types/jquery</code> è¿™ä¸ªä¾èµ–ï¼ˆè¿™æ˜¯ 2.0 çš„åšæ³•ï¼Œ1.0 ç¨æœ‰åŒºåˆ«ï¼‰ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼š<code>TS2688: Cannot find type definition file for 'unist'.</code>ã€‚</p> <h2 id="webpackdevserver-è¯·æ±‚è½¬å‘"><a href="#webpackdevserver-è¯·æ±‚è½¬å‘" class="header-anchor">#</a> WebpackDevServer è¯·æ±‚è½¬å‘</h2> <h3 id="proxy"><a href="#proxy" class="header-anchor">#</a> proxy</h3> <p><code>WebpackDevServer</code> çš„ <code>proxy</code> æ˜¯å¯ä»¥ç›´æ¥é…ç½®ä»£ç†çš„ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    proxy<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'/react/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token string">'https://www.xxx.com'</span><span class="token punctuation">,</span>
        secure<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// å¯ä»¥å¯¹ https ç”Ÿæ•ˆ</span>
        pathRewrite<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// æ”¹å˜æ¥å£è·¯ç”±</span>
          <span class="token string">'header.json'</span><span class="token operator">:</span> <span class="token string">'demo.json'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// æœ‰äº›æ¥å£ä¸ºäº†é˜²æ­¢çˆ¬è™«æ˜¯ä¸å…è®¸æ”¹å˜ origin çš„ï¼Œè¿™é‡Œè®¾ç½®ä¸º true å°±å¯ä»¥äº†</span>
        headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// æ”¹å˜è¯·æ±‚å¤´</span>
          host<span class="token operator">:</span> <span class="token string">'www.xxx.com'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="historyapifallback"><a href="#historyapifallback" class="header-anchor">#</a> historyApiFallback</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    historyApiFallback<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>å¦‚æœä¸€ä¸ªé¡¹ç›®é‡Œåœ¨å†™å•é¡µé¢åº”ç”¨æ—¶ï¼ŒæŸä¸ªè·¯ç”±æˆ‘ä»¬æ²¡æœ‰é…ç½®æŸä¸ªè·¯ç”± Aï¼Œè®¿é—®æ—¶ä¼šæ˜¾ç¤º <code>can't get A</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥é…ç½® <code>historyApiFallback: true</code> æ¥å°†æ²¡æœ‰é…ç½®çš„é¡µé¢ç›´æ¥è½¬å‘ <code>index.html</code>ï¼Œè¯¦ç»†ç”¨æ³•è§ webpackå®˜ç½‘ã€‚</p> <h2 id="eslint"><a href="#eslint" class="header-anchor">#</a> ESLint</h2> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å®‰è£…</span>
<span class="token comment"># eslint æ˜¯å‘½ä»¤å·¥å…· eslint-loader æ˜¯åœ¨ç¼–è¯‘eræˆ–å¯åŠ¨é¡¹ç›®æ—¶å®æ—¶æŠ¥é”™</span>
<span class="token function">npm</span> <span class="token function">install</span> eslint eslint-loader --save-dev

<span class="token comment"># åˆå§‹åŒ– eslint è§„èŒƒï¼Œç”Ÿæˆ .eslintrc.js æ–‡ä»¶</span>
<span class="token comment"># Aribnb æ˜¯ä¸€ç§å¾ˆå˜æ€çš„è§„èŒƒ</span>
npx eslint init 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node-modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader'</span><span class="token punctuation">,</span> <span class="token string">'eslint-loader'</span><span class="token punctuation">]</span> <span class="token comment">// å…ˆè¿›è¡Œä»£ç æ£€éªŒï¼Œå†ç¼–è¯‘</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    overlay<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// å¦‚æœè¿‡ç¨‹å‡ºç°é”™è¯¯ï¼Œä¼šé€šè¿‡è’™å±‚æ¥æç¤ºé”™è¯¯</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><code>eslint-loader</code> è¿˜æœ‰è®¸å¤šé…ç½®å‚æ•°å¯ä»¥è®¾ç½®ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// webpack.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> 
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node-modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'eslint-loader'</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              fix<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// å¦‚æœæœ‰å°çš„é”™è¯¯ï¼Œå¯ä»¥ç›´æ¥ä¿®å¤</span>
              cache<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// ä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            enforce<span class="token operator">:</span> <span class="token string">'pre'</span> <span class="token comment">// è™½ç„¶åœ¨ babel-loader å‰é¢ï¼Œä½†æ˜¯å¯ä»¥æå‰æ‰§è¡Œ(å®é™…æµ‹è¯•è¿™ä¸ªå‚æ•°æ”¾åœ¨è¿™é‡Œæœ‰é—®é¢˜ï¼Œè¿™é‡Œçš„loaderå°±æŒ‰ç…§å®ƒæœ¬è¯¥æœ‰çš„å¾ªåºå»æ’åˆ—å®ƒï¼Œä¸è¦ä½¿ç”¨è¿™ä¸ªå‚æ•°å»æ§åˆ¶äº†)</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span> 
          <span class="token string">'babel-loader'</span>
        <span class="token punctuation">]</span> <span class="token comment">// å…ˆè¿›è¡Œä»£ç æ£€éªŒï¼Œå†ç¼–è¯‘</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devServer<span class="token operator">:</span> <span class="token punctuation">{</span>
    overlay<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// å¦‚æœè¿‡ç¨‹å‡ºç°é”™è¯¯ï¼Œä¼šé€šè¿‡è’™å±‚æ¥æç¤ºé”™è¯¯</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// .eslintrc.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;airbnb&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;parser&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel-eslint&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;react/prefer-stateless-function&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token string">&quot;react/jsx-filename-extension&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  globals<span class="token operator">:</span> <span class="token punctuation">{</span>
    document<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// è§£å†³å…¨å±€å˜é‡å‡ºé”™</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>VSCode å®‰è£… ESLint æ’ä»¶ï¼Œå®æ—¶æ˜¾ç¤ºé”™è¯¯ã€‚</p></blockquote> <p>å¦‚æœæŠ¥é”™ <code>Eslint parsing error: Unexpected token &lt;</code>ï¼Œå¯ä»¥å€ŸåŠ© <a href="https://github.com/BenoitZugmeyer/eslint-plugin-html" target="_blank" rel="noopener noreferrer">eslint-plugin-html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>æ¥è§£å†³ã€‚</p> <div class="custom-block tip"><p>å®é™…é¡¹ç›®ä¸­ä¸ºäº†ä¸å½±å“æ‰“åŒ…é€Ÿåº¦ï¼Œå¯ä»¥ä¸é…ç½® <code>eslint-loader</code>ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ git é’©å­ï¼Œåœ¨æäº¤å‘½ä»¤ä»£ç æ—¶è¿›è¡Œæ£€æµ‹ï¼Œå½“ç„¶è¿™ä¸ªæ—¶å€™å°±æ”¾å¼ƒäº†å®æ—¶æŠ¥é”™çš„ç‰¹æ€§ã€‚</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">git</span> é’©å­ eslint src
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <h2 id="æå‡æ‰“åŒ…é€Ÿåº¦"><a href="#æå‡æ‰“åŒ…é€Ÿåº¦" class="header-anchor">#</a> æå‡æ‰“åŒ…é€Ÿåº¦</h2> <ol><li>è·Ÿä¸ŠæŠ€æœ¯çš„è¿­ä»£ï¼Œä¿æŒæœ€æ–°ï¼ˆNode/Npm/Yarnï¼‰</li> <li>åœ¨å°½å¿«å°‘çš„æ¨¡å—ä¸Šä½¿ç”¨ <code>loader</code>ï¼Œæ¯”å¦‚é€šè¿‡ <code>include</code> å’Œ <code>exclude</code> æ¥æŒ‡å®šæ‰“åŒ…ç›‘å¬èŒƒå›´<div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li> <li>å°½é‡ç²¾ç®€ <code>plugin</code>ï¼Œå¹¶ä¸”ç¡®ä¿å…¶å¯é æ€§</li> <li>åˆç†é…ç½® extensions<div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// é…ç½®å¤ªå¤šå¤šå¼•å‘å¤šæ¬¡æŸ¥æ‰¾ï¼Œæ³¨æ„ç²¾ç®€</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.jsx'</span><span class="token punctuation">,</span> <span class="token string">'.css'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// å¼•ç”¨å¦‚æœå¼•ç”¨æ–‡ä»¶æ—¶åªå†™åˆ°ä¸Šçº§ç›®å½•ï¼Œä¼šé»˜è®¤å¼•ç”¨ index æ–‡ä»¶ï¼Œè¿™æ ·å¦‚æœæ²¡æœ‰ index å›å»æ‰¾ child æ–‡ä»¶ï¼Œä¹Ÿä¸è¦é…ç½®ç‰¹åˆ«å¤šï¼Œå°½é‡ä¸ä½¿ç”¨</span>
    mainFiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token string">'child'</span><span class="token punctuation">]</span>
    <span class="token comment">// é…ç½®åˆ«åï¼Œç¼©çŸ­å¼•ç”¨åç§°</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;@component&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../src/component'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ol> <h2 id="loader-åŸç†"><a href="#loader-åŸç†" class="header-anchor">#</a> Loader åŸç†</h2> <h3 id="å°æ¡ˆä¾‹"><a href="#å°æ¡ˆä¾‹" class="header-anchor">#</a> å°æ¡ˆä¾‹</h3> <p>åˆ›å»ºä¸€ä¸ªå¯ä»¥å°† å­—ç¬¦ä¸² <code>reco</code> æ›¿æ¢ä¸º <code>luan</code> çš„ç®€å• <code>loader</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// æ–°å»ºä¸€ä¸ªloader /loaders/replaceLoader.js</span>

<span class="token comment">// è¿™é‡Œä¸å¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'reco'</span><span class="token punctuation">,</span> <span class="token string">'luan'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/loaders/replaceLoader.js'</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="è·å–å‚æ•°"><a href="#è·å–å‚æ•°" class="header-anchor">#</a> è·å–å‚æ•°</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// å‚æ•°ä¼šè¢«æ”¾åœ¨ this.query é‡Œé¢</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query

  <span class="token comment">// æœ‰çš„æ—¶å€™ options å¯èƒ½ä¸æ˜¯å¯¹è±¡è€Œæ˜¯å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© loader-utils</span>
  <span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  <span class="token keyword">return</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'reco'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/loaders/replaceLoader.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              name<span class="token operator">:</span> <span class="token string">'luan'</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="ä¸°å¯Œåé¦ˆå†…å®¹"><a href="#ä¸°å¯Œåé¦ˆå†…å®¹" class="header-anchor">#</a> ä¸°å¯Œåé¦ˆå†…å®¹</h3> <p>å€ŸåŠ© <code>this.callback</code>ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>
  err<span class="token operator">:</span> Error <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  content<span class="token operator">:</span> string <span class="token operator">|</span> Buffer<span class="token punctuation">,</span>
  sourceMap<span class="token operator">?</span><span class="token operator">:</span> sourceMap<span class="token punctuation">,</span>
  meta<span class="token operator">?</span><span class="token operator">:</span> any
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'reco'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> sourceMap<span class="token punctuation">,</span> meta<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="resolveloader"><a href="#resolveloader" class="header-anchor">#</a> resolveLoader</h3> <p>ä½œç”¨æ˜¯å¯»æ‰¾ loader æ—¶å¯ä»¥ç›´æ¥å»æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–‡ä»¶å¤¹å†…å»å¯»æ‰¾ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// ä½¿ç”¨</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  resolveLoader<span class="token operator">:</span> <span class="token punctuation">{</span>
    modules<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'node_modules'</span><span class="token punctuation">,</span> <span class="token string">'./loaders'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> <span class="token string">'replaceLoader2'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            loader<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/loaders/replaceLoader.js'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            options<span class="token operator">:</span> <span class="token punctuation">{</span>
              name<span class="token operator">:</span> <span class="token string">'luan'</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="å¼‚æ­¥å¤„ç†"><a href="#å¼‚æ­¥å¤„ç†" class="header-anchor">#</a> å¼‚æ­¥å¤„ç†</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">asunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'reco'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> loaderUtils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'loader-utils'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> loaderUtils<span class="token punctuation">.</span><span class="token function">getOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'reco'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> result<span class="token punctuation">,</span> sourceMap<span class="token punctuation">,</span> meta<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>loader è¿˜å¯ä»¥åšå“ªäº›å·¥ä½œå‘¢ï¼Ÿæ¯”å¦‚ ç»™ä»£ç æ·»åŠ  try catchï¼Œæœ¬åœ°åŒ–ï¼Œæ›¿æ¢ä¸­è‹±æ–‡</p></blockquote> <h2 id="plugin-åŸç†"><a href="#plugin-åŸç†" class="header-anchor">#</a> Plugin åŸç†</h2> <h3 id="ç®€å•-plugin"><a href="#ç®€å•-plugin" class="header-anchor">#</a> ç®€å• Plugin</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /plugins/copyright-webpack-plugin.js</span>

<span class="token keyword">class</span> <span class="token class-name">CopyrightWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token comment">// { name: 'reco' }</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// compiler æ˜¯ webapck çš„ä¸€ä¸ªå®ä¾‹ï¼Œå­˜æ”¾ç€é…ç½®ç­‰æ‰€æœ‰çš„ä¸œè¥¿</span>
  <span class="token function">apply</span> <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * hooks       æ˜¯é’©å­
     * emit        å°†æ‰“åŒ…å¥½çš„æ–‡ä»¶æ”¾åˆ°è¾“å‡ºç›®å½•ä¹‹å‰ï¼ˆå¼‚æ­¥é’©å­ï¼‰
     * compilation å’Œæœ¬æ¬¡æ‰“åŒ…ç›¸å…³çš„ä¸œè¥¿
    */</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'CopyrightWebpackPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// å¢åŠ ä¸€ä¸ª txt æ–‡ä»¶</span>
      compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">'copyright.txt'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token comment">/**
         * source æ–‡æœ¬å†…å®¹
         * size   æ–‡æœ¬å­—èŠ‚å¤§å°
        */</span>
        <span class="token function-variable function">source</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token string">'copyright by reco_luan'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">size</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token number">22</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// å¿…é¡»å›è°ƒ</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// compile åŒæ­¥é’©å­ï¼Œä¸éœ€è¦callback</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'CopyrightWebpackPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŒæ­¥é’©å­'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyrightWebpackPlugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /webpack.config.js</span>

<span class="token keyword">const</span> CopyrightWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'/plugins/copyright-webpack-plugin.js'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">CopyrightWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'reco'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="node-è°ƒè¯•"><a href="#node-è°ƒè¯•" class="header-anchor">#</a> Node è°ƒè¯•</h3> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// package.json</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;debug&quot;</span><span class="token operator">:</span> <span class="token string">&quot;node --inspect --inspect-brk node_modules/webpack/bin/webpack.js&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><code>--inspect</code> å¼€å¯ Node è°ƒè¯•</li> <li><code>--inspect-brk</code> åœ¨ä»£ç ç¬¬ä¸€è¡Œæ·»åŠ ä¸€ä¸ª debug å‘½ä»¤</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">CopyrightWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span> <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'CopyrightWebpackPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ‰“æ–­ç‚¹</span>
      <span class="token keyword">debugger</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'åŒæ­¥é’©å­'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> CopyrightWebpackPlugin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>æ‰“å¼€æ§åˆ¶å°çš„ Node å›¾æ ‡ï¼Œå°±è¿›å…¥äº† Node è°ƒè¯•</p> <h2 id="bundler-æºç ç¼–å†™"><a href="#bundler-æºç ç¼–å†™" class="header-anchor">#</a> Bundler æºç ç¼–å†™</h2> <h3 id="å…¥å£æ–‡ä»¶åˆ†æ"><a href="#å…¥å£æ–‡ä»¶åˆ†æ" class="header-anchor">#</a> å…¥å£æ–‡ä»¶åˆ†æ</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/parser'</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/traverse'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default


<span class="token comment">// ************ å…¥å£æ–‡ä»¶åˆ†æ **************</span>
<span class="token keyword">const</span> <span class="token function-variable function">moduleAnalyser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯»å–æ–‡ä»¶</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>

  <span class="token comment">//åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    sourceType<span class="token operator">:</span> <span class="token string">'module'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// åˆ†æä¾èµ–</span>
  <span class="token keyword">let</span> dependencies <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// ç¬¬ä¸€ä¸ªè¯­æ³•æ˜¯æŠ½è±¡è¯­æ³•æ ‘</span>
    <span class="token function">ImportDeclaration</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è·å–ä¾èµ–çš„ç›¸å¯¹è·¯å¾„</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value
      <span class="token keyword">const</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
      <span class="token keyword">const</span> newFile <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>

      <span class="token comment">// key: å°†ç›¸å¯¹è·¯å¾„ value: ç»å¯¹è·¯å¾„</span>
      dependencies<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> newFile
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// å°† ES6 è¯­æ³•è½¬è¯‘ä¸º æµè§ˆå™¨å¯ä»¥æ‰§è¡Œçš„è¯­æ³•</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// éœ€è¦å®‰è£… @babel/preset-env</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">/**
   * filename     // å…¥å£æ–‡ä»¶
   * dependencies // ä¾èµ–å…³ç³»
   * code         // æ‰“åŒ…åçš„ä»£ç 
  */</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">,</span>
    dependencies<span class="token punctuation">,</span>
    code
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> moduleInfo <span class="token operator">=</span> <span class="token function">moduleAnalyser</span><span class="token punctuation">(</span><span class="token string">'./src/index.js'</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>moduleInfo<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h3 id="ä¾èµ–å›¾è°±"><a href="#ä¾èµ–å›¾è°±" class="header-anchor">#</a> ä¾èµ–å›¾è°±</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/parser'</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/traverse'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default

<span class="token comment">// ************ å…¥å£æ–‡ä»¶åˆ†æ **************</span>
<span class="token keyword">const</span> <span class="token function-variable function">moduleAnalyser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯»å–æ–‡ä»¶</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>

  <span class="token comment">//åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    sourceType<span class="token operator">:</span> <span class="token string">'module'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// åˆ†æä¾èµ–</span>
  <span class="token keyword">let</span> dependencies <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// ç¬¬ä¸€ä¸ªè¯­æ³•æ˜¯æŠ½è±¡è¯­æ³•æ ‘</span>
    <span class="token function">ImportDeclaration</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è·å–ä¾èµ–çš„ç›¸å¯¹è·¯å¾„</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value
      <span class="token keyword">const</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
      <span class="token keyword">const</span> newFile <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>

      <span class="token comment">// key: å°†ç›¸å¯¹è·¯å¾„ value: ç»å¯¹è·¯å¾„</span>
      dependencies<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> newFile
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// å°† ES6 è¯­æ³•è½¬è¯‘ä¸º æµè§ˆå™¨å¯ä»¥æ‰§è¡Œçš„è¯­æ³•</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// éœ€è¦å®‰è£… @babel/preset-env</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">/**
   * filename     // å…¥å£æ–‡ä»¶
   * dependencies // ä¾èµ–å…³ç³»
   * code         // æ‰“åŒ…åçš„ä»£ç 
  */</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">,</span>
    dependencies<span class="token punctuation">,</span>
    code
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// const moduleInfo = moduleAnalyser('./src/index.js')</span>
<span class="token comment">// console.log(moduleInfo)</span>

<span class="token comment">// ************ ä¾èµ–å›¾è°± **************</span>
<span class="token keyword">const</span> <span class="token function-variable function">makeDependenciesGraph</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// é¦–å…ˆåœ¨ä¾èµ–å›¾è°±ä¸­æ’å…¥å…¥å£æ–‡ä»¶çš„åˆ†æ</span>
  <span class="token keyword">const</span> entryModule <span class="token operator">=</span> <span class="token function">moduleAnalyser</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span>
  <span class="token keyword">const</span> graphArray <span class="token operator">=</span> <span class="token punctuation">[</span> entryModule <span class="token punctuation">]</span>

  <span class="token comment">/**
   * å¾ªç¯å…¥å£æ–‡ä»¶çš„ä¾èµ–å¹¶å°†å…¶æ·»åŠ åˆ° graphArray ä¸­ï¼Œå› ä¸º graphArray æ˜¯åŠ¨æ€çš„ï¼Œ
   * graphArray.length ä¹Ÿæ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯
   */</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> graphArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> graphArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> dependencies <span class="token punctuation">}</span> <span class="token operator">=</span> item
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dependencies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token keyword">in</span> dependencies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        graphArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">moduleAnalyser</span><span class="token punctuation">(</span>dependencies<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¾é”®å€¼å¯¹çš„å½¢å¼é‡æ–°ç»„åˆæ•°æ®</span>
  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  graphArray<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    graph<span class="token punctuation">[</span>item<span class="token punctuation">.</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      dependencies<span class="token operator">:</span> item<span class="token punctuation">.</span>dependencies<span class="token punctuation">,</span>
      code<span class="token operator">:</span> item<span class="token punctuation">.</span>code
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> graph
<span class="token punctuation">}</span>

<span class="token keyword">const</span> graphInfo <span class="token operator">=</span> <span class="token function">makeDependenciesGraph</span><span class="token punctuation">(</span><span class="token string">'./src/index.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>graphInfo<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><h3 id="ç”Ÿæˆå¯ç”¨ä»£ç "><a href="#ç”Ÿæˆå¯ç”¨ä»£ç " class="header-anchor">#</a> ç”Ÿæˆå¯ç”¨ä»£ç </h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/parser'</span><span class="token punctuation">)</span> <span class="token comment">// åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
<span class="token keyword">const</span> traverse <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/traverse'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default

<span class="token comment">// ************ å…¥å£æ–‡ä»¶åˆ†æ **************</span>
<span class="token keyword">const</span> <span class="token function-variable function">moduleAnalyser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¯»å–æ–‡ä»¶</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>

  <span class="token comment">//åˆ†ææŠ½è±¡è¯­æ³•æ ‘</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>content<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    sourceType<span class="token operator">:</span> <span class="token string">'module'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// åˆ†æä¾èµ–</span>
  <span class="token keyword">let</span> dependencies <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token function">traverse</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token comment">// ç¬¬ä¸€ä¸ªè¯­æ³•æ˜¯æŠ½è±¡è¯­æ³•æ ‘</span>
    <span class="token function">ImportDeclaration</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> node <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// è·å–ä¾èµ–çš„ç›¸å¯¹è·¯å¾„</span>
      <span class="token keyword">const</span> value <span class="token operator">=</span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value
      <span class="token keyword">const</span> dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
      <span class="token keyword">const</span> newFile <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">./</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>

      <span class="token comment">// key: å°†ç›¸å¯¹è·¯å¾„ value: ç»å¯¹è·¯å¾„</span>
      dependencies<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> newFile
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// å°† ES6 è¯­æ³•è½¬è¯‘ä¸º æµè§ˆå™¨å¯ä»¥æ‰§è¡Œçš„è¯­æ³•</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAst</span><span class="token punctuation">(</span>ast<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// éœ€è¦å®‰è£… @babel/preset-env</span>
    presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">/**
   * filename     // å…¥å£æ–‡ä»¶
   * dependencies // ä¾èµ–å…³ç³»
   * code         // æ‰“åŒ…åçš„ä»£ç 
  */</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">,</span>
    dependencies<span class="token punctuation">,</span>
    code
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// const moduleInfo = moduleAnalyser('./src/index.js')</span>
<span class="token comment">// console.log(moduleInfo)</span>

<span class="token comment">// ************ ä¾èµ–å›¾è°± *****************</span>
<span class="token keyword">const</span> <span class="token function-variable function">makeDependenciesGraph</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// é¦–å…ˆåœ¨ä¾èµ–å›¾è°±ä¸­æ’å…¥å…¥å£æ–‡ä»¶çš„åˆ†æ</span>
  <span class="token keyword">const</span> entryModule <span class="token operator">=</span> <span class="token function">moduleAnalyser</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span>
  <span class="token keyword">const</span> graphArray <span class="token operator">=</span> <span class="token punctuation">[</span> entryModule <span class="token punctuation">]</span>

  <span class="token comment">/**
   * å¾ªç¯å…¥å£æ–‡ä»¶çš„ä¾èµ–å¹¶å°†å…¶æ·»åŠ åˆ° graphArray ä¸­ï¼Œå› ä¸º graphArray æ˜¯åŠ¨æ€çš„ï¼Œ
   * graphArray.length ä¹Ÿæ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯
   */</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> graphArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> graphArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> dependencies <span class="token punctuation">}</span> <span class="token operator">=</span> item
    <span class="token keyword">if</span> <span class="token punctuation">(</span>dependencies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token keyword">in</span> dependencies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        graphArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">moduleAnalyser</span><span class="token punctuation">(</span>dependencies<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ä¾é”®å€¼å¯¹çš„å½¢å¼é‡æ–°ç»„åˆæ•°æ®</span>
  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  graphArray<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    graph<span class="token punctuation">[</span>item<span class="token punctuation">.</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      dependencies<span class="token operator">:</span> item<span class="token punctuation">.</span>dependencies<span class="token punctuation">,</span>
      code<span class="token operator">:</span> item<span class="token punctuation">.</span>code
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> graph
<span class="token punctuation">}</span>

<span class="token comment">// const graphInfo = makeDependenciesGraph('./src/index.js')</span>
<span class="token comment">// console.log(graphInfo)</span>

<span class="token comment">// ************ ç”Ÿæˆä»£ç  *****************</span>
<span class="token keyword">const</span> <span class="token function-variable function">generateCode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ä¾èµ–æ ‘æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦è§£ææˆå­—ç¬¦ä¸²</span>
  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token function">makeDependenciesGraph</span><span class="token punctuation">(</span>entry<span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">/**
   * ä¾èµ–æ ‘æ¯ä¸ªæ¨¡å—å¯¹åº”çš„ä»£ç éƒ½éœ€è¦ require/modules å¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦è‡ªå·±æ¥æ„å»º
   */</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    (function (graph) {
      function require (module) {
        // require éœ€è¦å¼•ç”¨ç›¸å¯¹è·¯å¾„ï¼Œæ‰€ä»¥åˆ›å»º localRequire
        function localRequire (relativePath) {
          return require(graph[module].dependencies[relativePath])
        }

        // æ²¡æœ‰ exports å¯¹è±¡ï¼Œéœ€è¦æ‰‹åŠ¨åˆ›å»º
        // åˆ‡è®°ï¼Œè¿™é‡Œçš„ åˆ†å· æ˜¯å¿…é¡»æœ‰çš„
        var exports = {};
        (function (require, exports, code) {
          // æ‰§è¡Œä»£ç 
          eval(code)
        })(localRequire, exports, graph[module].code)

        // å¯¼å‡ºååˆ«çš„ä¾èµ–ï¼Œæ‰èƒ½è¿›è¡Œå¼•ç”¨
        return exports
      }
      require('</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entry<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">')
    })(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>graph<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)
  </span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> code <span class="token operator">=</span> <span class="token function">generateCode</span><span class="token punctuation">(</span><span class="token string">'./src/index.js'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br></div></div><h2 id="æ·±å…¥å­¦ä¹ "><a href="#æ·±å…¥å­¦ä¹ " class="header-anchor">#</a> æ·±å…¥å­¦ä¹ </h2> <h3 id="createreactapp"><a href="#createreactapp" class="header-anchor">#</a> CreateReactApp</h3> <h3 id="vue-cli"><a href="#vue-cli" class="header-anchor">#</a> vue-cli</h3> <h3 id="vue"><a href="#vue" class="header-anchor">#</a> Vue</h3> <h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="header-anchor">#</a> å…¶ä»–</h2> <h3 id="æ¸…é™¤æ€§èƒ½æŠ¥é”™"><a href="#æ¸…é™¤æ€§èƒ½æŠ¥é”™" class="header-anchor">#</a> æ¸…é™¤æ€§èƒ½æŠ¥é”™</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  performance<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="å¯åŠ¨ä¸€ä¸ªæœåŠ¡"><a href="#å¯åŠ¨ä¸€ä¸ªæœåŠ¡" class="header-anchor">#</a> å¯åŠ¨ä¸€ä¸ªæœåŠ¡</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> http-server -D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°† dist ç›®å½• ä½œä¸ºæ ¹ç›®å½•å¯åŠ¨æœåŠ¡ï¼š</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http-server dist&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">10/29/2020, 3:34:21 PM</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><div class="kanbanniang" data-v-5775ee02><div class="banniang-container" style="display:;" data-v-5775ee02><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-5775ee02>
      æ¬¢è¿æ¥åˆ° Sunã®Blog
    </div> <div class="operation" style="right:90px;bottom:40px;display:none;" data-v-5775ee02><i class="kbnfont kbn-ban-home ban-home" data-v-5775ee02></i> <i class="kbnfont kbn-ban-message message" data-v-5775ee02></i> <i class="kbnfont kbn-ban-close close" data-v-5775ee02></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-5775ee02><i class="kbnfont kbn-ban-info info" data-v-5775ee02></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-5775ee02></i></div> <canvas id="banniang" width="220" height="220" class="live2d" style="left:5px;bottom:-20px;opacity:0.9;" data-v-5775ee02></canvas></div> <div class="showBanNiang" style="display:none;" data-v-5775ee02>
    çœ‹æ¿å¨˜
  </div></div><canvas id="vuepress-canvas-ribbon"></canvas></div></div>
    <script src="/assets/js/app.b9161754.js" defer></script><script src="/assets/js/3.89f5aeb4.js" defer></script><script src="/assets/js/1.f8fc9ec2.js" defer></script><script src="/assets/js/53.c04f220a.js" defer></script>
  </body>
</html>
